{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[44],{\"JyM/\":function(module,__webpack_exports__,__webpack_require__){\"use strict\";__webpack_require__.r(__webpack_exports__);var core=__webpack_require__(\"8Y7J\"),ngx=__webpack_require__(\"egMn\"),shared_data_service=__webpack_require__(\"UmVP\"),config_service=__webpack_require__(\"sf9b\"),loading_service=__webpack_require__(\"KTio\"),location_data_service=__webpack_require__(\"PpuG\");class ShippingMethodPage{constructor(navCtrl,shared,http,storage,spinnerDialog,config,loading,location,applicationRef){this.navCtrl=navCtrl,this.shared=shared,this.http=http,this.storage=storage,this.spinnerDialog=spinnerDialog,this.config=config,this.loading=loading,this.location=location,this.applicationRef=applicationRef,this.shippingMethod=new Array,this.selectedMethod=!0,this.shippingLocations=[],this.resetPage=!1,console.log(this.shared.customerData),this.shared.translateString(this.shared.checkOutPageText).then(res=>{this.shared.checkOutPageText=res}),this.getShippingZones()}getShippingZones(){this.loading.show(),this.config.getWoo(\"shipping/zones?\"+this.config.productsArguments).then(data=>{this.getShippingLocations(data)})}getShippingLocations(array){var count=0;for(let v of array)this.config.getWoo(\"shipping/zones/\"+v.id+\"/locations?\"+this.config.productsArguments).then(data=>{count++;let d=data;for(let v2 of d)this.shippingLocations.push(Object.assign(v2,{zoneId:v.id}));array.length==count&&(this.loading.hide(),this.sortArray(this.shippingLocations))})}sortArray(array){let tempArray=[];for(let value of array)\"postcode\"==value.type&&tempArray.push(value);for(let value of array)\"state\"==value.type&&tempArray.push(value);for(let value of array)\"country\"==value.type&&tempArray.push(value);for(let value of array)\"continent\"==value.type&&tempArray.push(value);console.log(tempArray),this.findZoneId(tempArray)}findZoneId(array){let zoneId=\"\";for(let value of array)if(\"postcode\"==value.type){if(this.matchPostCode(value)){zoneId=value.zoneId,console.log(\"postcode  \"+value.code);break}}else if(\"state\"==value.type){if(this.matchState(value)){console.log(\"state  \"+value.code),zoneId=value.zoneId;break}}else if(\"country\"==value.type){if(this.matchCountry(value)){console.log(\"country  \"+value.code),zoneId=value.zoneId;break}}else if(\"continent\"==value.type&&this.matchContinent(value)){console.log(\"continent  \"+value.code),zoneId=value.zoneId;break}this.getShippingMethods(zoneId)}matchPostCode(value){let postcode=this.shared.shipping.postcode;if(value.code.toUpperCase()==postcode.toUpperCase())return!0;if(value.code.indexOf(\"*\")>0){let ind=value.code.indexOf(\"*\"),s1=postcode.substring(0,ind-1),s2=value.code.substring(0,ind-1);if(s1.toUpperCase()==s2.toUpperCase())return!0}if(value.code.indexOf(\".\")>0){let i=value.code.indexOf(\".\"),min=value.code.substring(0,i),max=value.code.substring(i+3,value.code.length);min=parseInt(min);let p=parseInt(postcode);if(max=parseInt(max),p>=min&&p<=max)return!0}}matchState(value){if(this.shared.shipping.country+\":\"+this.shared.shipping.state==value.code)return!0}matchCountry(value){if(this.shared.shipping.country==value.code)return!0}matchContinent(value){if(this.location.getContientCode(this.shared.shipping.country)==value.code)return!0}getShippingMethods(id){\"\"==id&&(id=0),this.loading.show(),this.config.getWoo(\"shipping/zones/\"+id+\"/methods?\"+this.config.productsArguments).then(data=>{this.loading.hide(),this.shippingMethod=data,this.applicationRef.tick()})}setMethod(event){let data=event.detail.value;this.shared.shipping_lines=[];var s={};if(\"flat_rate\"==data.method_id)s={ship_id:data.id,method_id:data.method_id,method_title:data.method_title,total:this.calculateFlatRate(data)};else if(data.settings.cost){let cal=data.settings.cost.value.toString();\"\"==cal&&(cal=\"0\"),s={ship_id:data.id,method_id:data.method_id,method_title:data.method_title,total:cal}}else s={ship_id:data.id,method_id:data.method_id,method_title:data.method_title,total:\"0\"};console.log(s),this.shared.shipping_lines.push(s)}calculateFlatRate(data){let cal=data.settings.cost.value.toString();return\"\"==cal&&(cal=\"0\"),cal}checkFreeShipping(data){return\"free_shipping\"!=data.method_id||\"\"==data.settings.requires.value||(\"coupon\"==data.settings.requires.value?!!this.findFreeShippingCoupon():\"both\"==data.settings.requires.value?!!(this.shared.productsTotal()>=data.settings.min_amount.value&&this.findFreeShippingCoupon()):\"either\"==data.settings.requires.value?!!(this.shared.productsTotal()>=data.settings.min_amount.value||this.findFreeShippingCoupon()):\"min_amount\"==data.settings.requires.value?this.shared.productsTotal()>=data.settings.min_amount.value:void 0)}findFreeShippingCoupon(){let found=!1;if(0==this.shared.couponArray.length)return!1;for(let value of this.shared.couponArray)1==value.free_shipping&&(found=!0);return 1==found}proceedOrder(){2==this.config.checkOutPage?this.navCtrl.navigateForward(this.config.currentRoute+\"/order\"):this.openOrderPage()}openOrderPage(){let customer_id=0;null!=this.shared.customerData.id&&(customer_id=this.shared.customerData.id);let token=null;null!=this.shared.customerData.cookie&&(token=this.shared.customerData.cookie);let onePage=this.config.checkOutPage;var data={token:token,billing_info:this.shared.billing,shipping_info:this.shared.shipping,products:this.getProducts(),shipping_ids:this.shared.shipping_lines,coupons:this.getCoupons(),customer_note:\"\",customer_id:customer_id,sameAddress:this.shared.sameAddress,one_page:onePage,platform:this.shared.device};console.log(data),this.shared.openCheckoutWebview(data)}getProducts(){var data=[];for(let v of this.shared.cartProducts){var obj={quantity:v.quantity,product_id:v.product_id,total:v.total.toString()};v.variation_id&&Object.assign(obj,{variation_id:v.variation_id}),data.push(obj)}return data}getCoupons(){var data=[];for(let v of this.shared.couponArray)data.push({code:v.code,discount:v.amount});return data}getShippingLines(){var data=[];for(let v of this.shared.shipping_lines)data.push({code:v.code,discount:v.amount});return data}updateUser(){this.config.Woocommerce.putAsync(\"customers/\"+this.shared.customerData.id,{billing:this.shared.billing,shipping:this.shared.shipping}).then(data=>{let dat=data;this.shared.customerData.billing=dat.billing,this.shared.customerData.shipping=dat.shipping,this.storage.set(\"customerData\",this.shared.customerData)})}ionViewDidEnter(){this.resetPage=!1,setTimeout(()=>{this.resetPage=!0},100),this.shared.shipping_lines=[]}ngOnInit(){}}class ShippingMethodPageModule{}var router_ngfactory=__webpack_require__(\"pMnS\"),ionic_angular_ngfactory=__webpack_require__(\"MKJQ\"),ionic_angular=__webpack_require__(\"sZkV\"),common=__webpack_require__(\"SVse\"),fesm2015_forms=__webpack_require__(\"s7LF\"),translate_app_pipe=__webpack_require__(\"taci\"),curency_pipe=__webpack_require__(\"4How\"),http=__webpack_require__(\"IheW\"),ionic_storage=__webpack_require__(\"xgBC\"),RenderType_ShippingMethodPage=core.nb({encapsulation:0,styles:[[\"ion-footer[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{height:45px;margin:0}\"]],data:{}});function View_ShippingMethodPage_4(_l){return core.Kb(0,[(_l()(),core.pb(0,0,null,null,2,\"span\",[],null,null,null,null,null)),(_l()(),core.Ib(1,null,[\"\",\"\"])),core.Eb(2,1)],null,(function(_ck,_v){var currVal_0=core.Jb(_v,1,0,_ck(_v,2,0,core.Bb(_v.parent.parent.parent.parent,1),_v.parent.parent.context.$implicit.settings.cost.value));_ck(_v,1,0,currVal_0)}))}function View_ShippingMethodPage_3(_l){return core.Kb(0,[(_l()(),core.pb(0,0,null,null,10,\"ion-item\",[[\"lines\",\"full\"]],null,null,null,ionic_angular_ngfactory.Gb,ionic_angular_ngfactory.y)),core.ob(1,49152,null,0,ionic_angular.I,[core.h,core.k,core.x],{lines:[0,\"lines\"]},null),(_l()(),core.pb(2,0,null,0,4,\"ion-label\",[],null,null,null,ionic_angular_ngfactory.Hb,ionic_angular_ngfactory.B)),core.ob(3,49152,null,0,ionic_angular.O,[core.h,core.k,core.x],null,null),(_l()(),core.Ib(4,0,[\"\",\" \"])),(_l()(),core.eb(16777216,null,0,1,null,View_ShippingMethodPage_4)),core.ob(6,16384,null,0,common.k,[core.M,core.J],{ngIf:[0,\"ngIf\"]},null),(_l()(),core.pb(7,0,null,0,3,\"ion-radio\",[],null,[[null,\"ionBlur\"],[null,\"ionSelect\"]],(function(_v,en,$event){var ad=!0;return\"ionBlur\"===en&&(ad=!1!==core.Bb(_v,10)._handleBlurEvent($event.target)&&ad),\"ionSelect\"===en&&(ad=!1!==core.Bb(_v,10)._handleIonSelect($event.target)&&ad),ad}),ionic_angular_ngfactory.Ob,ionic_angular_ngfactory.H)),core.Fb(5120,null,fesm2015_forms.e,(function(p0_0){return[p0_0]}),[ionic_angular.Lb]),core.ob(9,49152,null,0,ionic_angular.Y,[core.h,core.k,core.x],{value:[0,\"value\"]},null),core.ob(10,4341760,null,0,ionic_angular.Lb,[core.p,core.k],null,null)],(function(_ck,_v){_ck(_v,1,0,\"full\"),_ck(_v,6,0,_v.parent.context.$implicit.settings.cost),_ck(_v,9,0,_v.parent.context.$implicit)}),(function(_ck,_v){_ck(_v,4,0,_v.parent.context.$implicit.method_title)}))}function View_ShippingMethodPage_2(_l){return core.Kb(0,[(_l()(),core.pb(0,0,null,null,2,\"div\",[],null,null,null,null,null)),(_l()(),core.eb(16777216,null,null,1,null,View_ShippingMethodPage_3)),core.ob(2,16384,null,0,common.k,[core.M,core.J],{ngIf:[0,\"ngIf\"]},null)],(function(_ck,_v){_ck(_v,2,0,_v.context.$implicit.enabled&&_v.component.checkFreeShipping(_v.context.$implicit))}),null)}function View_ShippingMethodPage_1(_l){return core.Kb(0,[(_l()(),core.pb(0,0,null,null,7,\"ion-list\",[[\"class\",\"ion-padding\"]],null,null,null,ionic_angular_ngfactory.Jb,ionic_angular_ngfactory.C)),core.ob(1,49152,null,0,ionic_angular.P,[core.h,core.k,core.x],null,null),(_l()(),core.pb(2,0,null,0,5,\"ion-radio-group\",[],null,[[null,\"ionChange\"],[null,\"ionBlur\"]],(function(_v,en,$event){var ad=!0,_co=_v.component;return\"ionBlur\"===en&&(ad=!1!==core.Bb(_v,5)._handleBlurEvent($event.target)&&ad),\"ionChange\"===en&&(ad=!1!==core.Bb(_v,5)._handleChangeEvent($event.target)&&ad),\"ionChange\"===en&&(ad=!1!==_co.setMethod($event)&&ad),ad}),ionic_angular_ngfactory.Nb,ionic_angular_ngfactory.I)),core.Fb(5120,null,fesm2015_forms.e,(function(p0_0){return[p0_0]}),[ionic_angular.Nb]),core.ob(4,49152,null,0,ionic_angular.Z,[core.h,core.k,core.x],null,null),core.ob(5,4341760,null,0,ionic_angular.Nb,[core.p,core.k],null,null),(_l()(),core.eb(16777216,null,0,1,null,View_ShippingMethodPage_2)),core.ob(7,278528,null,0,common.j,[core.M,core.J,core.q],{ngForOf:[0,\"ngForOf\"]},null)],(function(_ck,_v){_ck(_v,7,0,_v.component.shippingMethod)}),null)}function View_ShippingMethodPage_0(_l){return core.Kb(0,[core.Db(0,translate_app_pipe.a,[shared_data_service.a]),core.Db(0,curency_pipe.a,[]),(_l()(),core.pb(2,0,null,null,12,\"ion-header\",[],null,null,null,ionic_angular_ngfactory.yb,ionic_angular_ngfactory.s)),core.ob(3,49152,null,0,ionic_angular.C,[core.h,core.k,core.x],null,null),(_l()(),core.pb(4,0,null,0,10,\"ion-toolbar\",[],null,null,null,ionic_angular_ngfactory.lc,ionic_angular_ngfactory.fb)),core.ob(5,49152,null,0,ionic_angular.Ab,[core.h,core.k,core.x],null,null),(_l()(),core.pb(6,0,null,0,4,\"ion-buttons\",[[\"slot\",\"start\"]],null,null,null,ionic_angular_ngfactory.lb,ionic_angular_ngfactory.f)),core.ob(7,49152,null,0,ionic_angular.m,[core.h,core.k,core.x],null,null),(_l()(),core.pb(8,0,null,0,2,\"ion-back-button\",[[\"icon\",\"arrow-back\"]],null,[[null,\"click\"]],(function(_v,en,$event){var ad=!0;return\"click\"===en&&(ad=!1!==core.Bb(_v,10).onClick($event)&&ad),ad}),ionic_angular_ngfactory.ib,ionic_angular_ngfactory.c)),core.ob(9,49152,null,0,ionic_angular.h,[core.h,core.k,core.x],{icon:[0,\"icon\"]},null),core.ob(10,16384,null,0,ionic_angular.i,[[2,ionic_angular.gb],ionic_angular.Hb,ionic_angular.e],null,null),(_l()(),core.pb(11,0,null,0,3,\"ion-title\",[],null,null,null,ionic_angular_ngfactory.jc,ionic_angular_ngfactory.db)),core.ob(12,49152,null,0,ionic_angular.yb,[core.h,core.k,core.x],null,null),(_l()(),core.Ib(13,0,[\"\",\"\"])),core.Eb(14,1),(_l()(),core.pb(15,0,null,null,3,\"ion-content\",[],null,null,null,ionic_angular_ngfactory.tb,ionic_angular_ngfactory.n)),core.ob(16,49152,null,0,ionic_angular.v,[core.h,core.k,core.x],null,null),(_l()(),core.eb(16777216,null,0,1,null,View_ShippingMethodPage_1)),core.ob(18,16384,null,0,common.k,[core.M,core.J],{ngIf:[0,\"ngIf\"]},null),(_l()(),core.pb(19,0,null,null,5,\"ion-footer\",[],null,null,null,ionic_angular_ngfactory.wb,ionic_angular_ngfactory.q)),core.ob(20,49152,null,0,ionic_angular.A,[core.h,core.k,core.x],null,null),(_l()(),core.pb(21,0,null,0,3,\"ion-button\",[[\"color\",\"secondary\"],[\"expand\",\"full\"]],null,[[null,\"click\"]],(function(_v,en,$event){var ad=!0;return\"click\"===en&&(ad=!1!==_v.component.proceedOrder()&&ad),ad}),ionic_angular_ngfactory.kb,ionic_angular_ngfactory.e)),core.ob(22,49152,null,0,ionic_angular.l,[core.h,core.k,core.x],{color:[0,\"color\"],disabled:[1,\"disabled\"],expand:[2,\"expand\"]},null),(_l()(),core.Ib(23,0,[\" \",\"\"])),core.Eb(24,1)],(function(_ck,_v){var _co=_v.component;_ck(_v,9,0,\"arrow-back\"),_ck(_v,18,0,_co.resetPage),_ck(_v,22,0,\"secondary\",0==_co.shared.shipping_lines.length,\"full\")}),(function(_ck,_v){var currVal_1=core.Jb(_v,13,0,_ck(_v,14,0,core.Bb(_v,0),\"Shipping Method\"));_ck(_v,13,0,currVal_1);var currVal_6=core.Jb(_v,23,0,_ck(_v,24,0,core.Bb(_v,0),\"Next\"));_ck(_v,23,0,currVal_6)}))}function View_ShippingMethodPage_Host_0(_l){return core.Kb(0,[(_l()(),core.pb(0,0,null,null,1,\"app-shipping-method\",[],null,null,null,View_ShippingMethodPage_0,RenderType_ShippingMethodPage)),core.ob(1,114688,null,0,ShippingMethodPage,[ionic_angular.Hb,shared_data_service.a,http.c,ionic_storage.b,ngx.a,config_service.a,loading_service.a,location_data_service.a,core.g],null,null)],(function(_ck,_v){_ck(_v,1,0)}),null)}var ShippingMethodPageNgFactory=core.lb(\"app-shipping-method\",ShippingMethodPage,View_ShippingMethodPage_Host_0,{},{},[]),router=__webpack_require__(\"iInd\"),pipes_module=__webpack_require__(\"wWlB\");__webpack_require__.d(__webpack_exports__,\"ShippingMethodPageModuleNgFactory\",(function(){return ShippingMethodPageModuleNgFactory}));var ShippingMethodPageModuleNgFactory=core.mb(ShippingMethodPageModule,[],(function(_l){return core.yb([core.zb(512,core.j,core.X,[[8,[router_ngfactory.a,ShippingMethodPageNgFactory]],[3,core.j],core.v]),core.zb(4608,common.m,common.l,[core.s,[2,common.v]]),core.zb(4608,fesm2015_forms.m,fesm2015_forms.m,[]),core.zb(4608,ionic_angular.c,ionic_angular.c,[core.x,core.g]),core.zb(4608,ionic_angular.Gb,ionic_angular.Gb,[ionic_angular.c,core.j,core.p]),core.zb(4608,ionic_angular.Kb,ionic_angular.Kb,[ionic_angular.c,core.j,core.p]),core.zb(1073742336,common.b,common.b,[]),core.zb(1073742336,fesm2015_forms.l,fesm2015_forms.l,[]),core.zb(1073742336,fesm2015_forms.c,fesm2015_forms.c,[]),core.zb(1073742336,ionic_angular.Cb,ionic_angular.Cb,[]),core.zb(1073742336,router.o,router.o,[[2,router.t],[2,router.m]]),core.zb(1073742336,pipes_module.a,pipes_module.a,[]),core.zb(1073742336,ShippingMethodPageModule,ShippingMethodPageModule,[]),core.zb(1024,router.k,(function(){return[[{path:\"\",component:ShippingMethodPage}]]}),[])])}))}}]);","extractedComments":[]}